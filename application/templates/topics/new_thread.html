{% extends 'layout.html' %}

{% block title %}
    New discussion
{% endblock %}

{% block content_title %}
    Create new discussion
{% endblock %}

{% block content %}
    <form action="{{ url_for('topics.add_thread', topic_slug=topic_slug) }}" method="POST">
        <div class="form-group">
            {{ form.hidden_tag() }}
            {{ form.name.label(class="control-label") }}
            {{ form.name(class="form-control") }}
            {{ form.checkbox(onchange='show_form()') }}
            {{ form.checkbox.label(class="control-label") }}
            <div class="secret_thread_form" style="display: none">
                Please choose users, who will be able to see the secret thread and the messages associated with it:<br>
                {{ form.users(class="form-control") }}
            </div>
        </div>

        <span class="error">
            {% if form.name.errors %}
                {% for error in form.name.errors %}
                    <div class="alert alert-primary">{{ error }}</div>
                {% endfor %}
            {% endif %}
        </span>

        <button type="submit" class="btn btn-info">Create discussion</button>
    </form>

    <script>
        const show_form = () => {
          let form = document.querySelector('.secret_thread_form');

          if (form.style.display === 'none') {
              form.style.display = 'block';
          } else {
             form.style.display = 'none';
          }
        };
    </script>
{% endblock %}